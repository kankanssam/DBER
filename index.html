<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>데이터 편향성 탐구 보고서</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* Noto Sans KR 폰트를 기본으로 사용 */
        body {
            font-family: 'Noto Sans KR', 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        /* 로딩 스피너 스타일 */
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .spinner {
            border-width: 4px;
            border-color: transparent;
            border-top-color: #3b82f6; /* 파란색 */
            animation: spin 1s linear infinite;
        }
        /* 제 완료 메시지 transition */
        .save-feedback {
            transition: opacity 0.5s ease-out;
        }
        /* iOS에서 input 그림자 제거 */
        input[type="text"], textarea {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex items-center justify-center p-4">

    <div id="loading-overlay" class="fixed inset-0 bg-white bg-opacity-75 flex flex-col items-center justify-center z-50 transition-opacity duration-300">
        <div class="spinner w-16 h-16 rounded-full"></div>
        <p class="mt-4 text-lg font-semibold text-gray-700">데이터 불러오는 중...</p>
    </div>

    <div class="w-full max-w-4xl mx-auto">
        
        <div id="example-screen" class="bg-white p-8 md:p-12 rounded-2xl shadow-xl border border-gray-200">
            <h1 class="text-3xl font-bold text-center text-blue-600 mb-4">데이터 편향성 탐구 보고서 (예시)</h1>
            <p class="text-center text-gray-600 mb-10">AI와 데이터를 공부하는 학생들을 위해, 보고서 작성 예시를 준비했습니다.</p>
            
            <div class="space-y-6 text-gray-800">
                <div>
                    <h2 class="text-xl font-semibold text-gray-900 border-l-4 border-blue-500 pl-3 mb-3">1. 내가 생각하는 데이터 편향성이란?</h2>
                    <p class="p-3 bg-gray-50 rounded-lg border border-gray-200 leading-relaxed">
                        데이터 편향성이란, 인공지능(AI)을 학습시키는 데이터가 현실 세계의 다양성을 골고루 반영하지 못하고 특정 집단에 치우쳐져 있는 상태를 의미합니다. 이러한 편향된 데이터로 학습한 AI는 결국 불공평하거나 차별적인 결정을 내릴 위험이 있습니다.
                    </p>
                </div>
                <div>
                    <h2 class="text-xl font-semibold text-gray-900 border-l-4 border-blue-500 pl-3 mb-3">2. 데이터 편향성 적용 사례</h2>
                    <p class="p-3 bg-gray-50 rounded-lg border border-gray-200 leading-relaxed">
                        가장 유명한 사례로 <strong>'AI 얼굴 인식 기술의 인종/성별 편향성'</strong>이 있습니다. MIT 미디어랩의 연구에 따르면, 특정 기업들의 얼굴 인식 AI가 백인 남성의 얼굴은 거의 100%에 가깝게 인식했지만, <strong>피부색이 어두운 여성의 얼굴은 인식률이 65%까지 떨어지는 것</strong>으로 나타났습니다.
                    </p>
                </div>
                 </div>


            <button id="start-report-btn" class="mt-10 w-full bg-blue-600 hover:bg-blue-700 text-white font-bold text-lg py-4 px-6 rounded-lg shadow-md transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-blue-300">
                보고서 작성 시작하기
            </button>
        </div>
        
        <div id="report-screen" class="hidden w-full max-w-4xl mx-auto bg-white p-8 md:p-12 rounded-2xl shadow-xl border border-gray-200">
            <h1 class="text-3xl font-bold text-center text-gray-800 mb-8">데이터 편향성 탐구 보고서</h1>
            
            <form id="report-form" class="space-y-6">
                
                <div class="flex flex-col sm:flex-row sm:space-x-4 space-y-4 sm:space-y-0 mb-6">
                    <div class="flex-1">
                        <label for="student-id" class="block text-lg font-semibold text-gray-700 mb-2">학번</label>
                        <input type="text" id="student-id" name="student-id" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="예: 10101" required>
                    </div>
                    <div class="flex-1">
                        <label for="student-name" class="block text-lg font-semibold text-gray-700 mb-2">이름</label>
                        <input type="text" id="student-name" name="student-name" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="예: 홍길동" required>
                    </div>
                </div>
                
                <hr class="border-gray-200">

                <div>
                    <label for="definition" class="block text-lg font-semibold text-gray-700 mb-2">1. 내가 생각하는 데이터 편향성이란?</label>
                    <textarea id="definition" name="definition" rows="4" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="데이터 편향성에 대한 자신의 정의를 자유롭게 작성해 주세요." required></textarea>
                </div>
                
                <div>
                    <label for="examples" class="block text-lg font-semibold text-gray-700 mb-2">2. 데이터 편향성 적용 사례</label>
                    <textarea id="examples" name="examples" rows="6" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="데이터 편향성이 적용된 실제 사례를 조사하여 작성해 주세요. (예: AI 채용, 얼굴 인식 등)" required></textarea>
                </div>
                
                <div>
                    <label for="example-links" class="block text-lg font-semibold text-gray-700 mb-2">관련 참고 링크 (선택)</label>
                    <textarea id="example-links" name="example-links" rows="3" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="조사한 사례와 관련된 뉴스 기사나 자료의 URL을 입력해 주세요. (여러 개일 경우 줄바꿈하여 입력)"></textarea>
                </div>
                
                <div>
                    <label for="analysis" class="block text-lg font-semibold text-gray-700 mb-2">3. 사례 분석 (원인)</label>
                    <textarea id="analysis" name="analysis" rows="5" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="해당 사례가 발생한 원인은 무엇이라고 생각하나요? (데이터 수집 과정, 알고리즘의 한계 등)" required></textarea>
                </div>
                
                <div>
                    <label for="solutions" class="block text-lg font-semibold text-gray-700 mb-2">4. 나의 생각 및 해결 방법</label>
                    <textarea id="solutions" name="solutions" rows="6" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="데이터 편향성을 해결하기 위한 본인만의 생각이나 아이디어를 작성해 주세요." required></textarea>
                </div>
                
                
                <div class="flex items-center justify-between pt-4">
                    <button type="submit" id="save-button" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-blue-300">
                        제출하기
                    </button>
                    <span id="save-feedback" class="font-semibold opacity-0 save-feedback">
                        ✓ 제출되었습니다!
                    </span>
                </div>
            </form>
        </div>
    </div>

    <script type="module">
        // --- 1. 여기에 2단계에서 복사한 웹 앱 URL을 붙여넣으세요 ---
        const WEB_APP_URL = "https://script.google.com/macros/s/AKfycby_9dnFIo3qvxXbQI2e7EsmxRic0omEL06X6qAQOpTGhMcEcv9ZhxKVGxbIqrI8hXPB2w/exec"; 
        // 예: const WEB_APP_URL = "https://script.google.com/macros/s/AKf.../exec";

        // --- DOM 요소 ---
        const loadingOverlay = document.getElementById('loading-overlay');
        const exampleScreen = document.getElementById('example-screen');
        const reportScreen = document.getElementById('report-screen');
        const startReportBtn = document.getElementById('start-report-btn');
        const reportForm = document.getElementById('report-form');
        const saveButton = document.getElementById('save-button');
        const saveFeedback = document.getElementById('save-feedback');

        // [수정됨] '제출하기' - Google Sheet로 전송하는 함수
        async function submitReport(event) {
            event.preventDefault(); // 폼 기본 제출 방지

            // URL이 입력되었는지 확인
            if (WEB_APP_URL === "여기에_2단계에서_복사한_URL을_붙여넣으세요") {
                alert("HTML 파일의 WEB_APP_URL 변수에 2단계에서 복사한 Apps Script URL을 입력해야 합니다.");
                return;
            }

            // 버튼 비활성화 및 로딩 상태 표시
            saveButton.disabled = true;
            saveButton.textContent = '제출 중...';
            saveFeedback.classList.remove('text-green-600', 'text-red-600');
            saveFeedback.classList.add('opacity-0');

            // FormData 객체를 사용하여 폼 데이터 캡처
            const formData = new FormData(reportForm);

            try {
                // fetch API를 사용하여 Google Apps Script URL로 POST 요청 전송
                const response = await fetch(WEB_APP_URL, {
                    method: 'POST',
                    body: formData,
                });

                const result = await response.json();

                if (result.result === "success") {
                    // 성공 UI 표시
                    saveFeedback.textContent = "✓ 제출되었습니다!";
                    saveFeedback.classList.add('text-green-600');
                    saveButton.textContent = '제출 완료';
                    saveButton.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                    saveButton.classList.add('bg-green-600');
                    saveFeedback.classList.remove('opacity-0');

                    // 3초 후 화면 전환 및 폼 초기화
                    setTimeout(() => {
                        // 1. 화면 전환
                        reportScreen.classList.add('hidden');
                        exampleScreen.classList.remove('hidden');
                        window.scrollTo(0, 0);
                        
                        // 2. 폼 초기화 (요청 사항)
                        reportForm.reset();
                        
                        // 3. 버튼 및 피드백 메시지 원상 복구
                        saveButton.disabled = false;
                        saveButton.textContent = '제출하기';
                        saveFeedback.classList.add('opacity-0');
                        saveButton.classList.remove('bg-green-600');
                        saveButton.classList.add('bg-blue-600', 'hover:bg-blue-700');

                    }, 3000); // 3초 대기

                } else {
                    // 실패 UI 표시
                    throw new Error(result.message || "알 수 없는 오류 발생");
                }

            } catch (error) {
                // 오류 처리
                console.error("데이터 제출 실패:", error);
                saveFeedback.textContent = "제출 실패. (콘솔 확인)";
                saveFeedback.classList.add('text-red-600'); // 빨간색
                saveFeedback.classList.remove('opacity-0');
                saveButton.disabled = false;
                saveButton.textContent = '다시 시도';
            }
        }
        
        // 앱 초기화 함수 (로딩 오버레이만 숨김)
        function initializeAppLocal() {
            loadingOverlay.classList.add('opacity-0');
            setTimeout(() => loadingOverlay.style.display = 'none', 300);
        }

        // --- 이벤트 리스너 ---
        
        // '보고서 작성 시작하기' 버튼 클릭
        startReportBtn.addEventListener('click', () => {
            exampleScreen.classList.add('hidden');
            reportScreen.classList.remove('hidden');
            window.scrollTo(0, 0); 
        });

        // [수정됨] '제출하기' 버튼 클릭 시 submitReport 함수 호출
        reportForm.addEventListener('submit', submitReport);
        
        // DOM이 준비되면 로컬 앱 초기화 시작
        document.addEventListener('DOMContentLoaded', initializeAppLocal);
        
    </script>
</body>
</html>
